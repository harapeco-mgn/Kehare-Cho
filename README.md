

# ケハレ帖（仮） — 今日のごはんに、小さなハレを。

**ケハレ帖（仮）**は、日常（ケ）に「ハレ」を足して、ありきたりな毎日に彩を足す **記録・共有**サービスです。
献立の“迷い”を減らしつつ、提案に頼らなくても「今日ハレを足した」行動が残せます。
ハレの記録は **ポイント／見た目の成長** と **カレンダーのスタンプ**で可視化されます。

> * **コンセプト：** 非日常（ハレ）と日常（ケ）の対比で捉える考え方がベース
> * **Note：** アプリ名は変更の可能性があります（現時点の候補：ケハレ帖）
> 
---

## 💡 このサービスへの思い・作りたい理由

前職でパティシエ／食品製造の現場にいたとき、日々の仕事は「ケ」が多い一方で、ウェディングなど“ハレ”の瞬間は強く記憶に残る体験だと感じていました。
季節感、香り、盛り付け、最後の一皿の余韻。ほんの小さな差が、その日を「特別な記憶」に変えることを何度も見てきました。

でも生活は基本的に「ケ」が大半で、特別な日を増やしたくても、献立を決めることや片付けが面倒で止まりがちです。
自分自身も「献立迷い（買い物前に家で迷う）」で時間が溶けるタイプでした。

一方で「新作・限定を選ぶ」「普段より少し予算を上げる」「デザートを足す」「コーヒー／紅茶を合わせる」といった小さな行動で、ケの日でも“プチハレ”は作れる。
このサービスは、そうした **“ハレを足す行動”を記録・共有し、続けるほど日常が少し楽しくなる体験**を作るために企画しました。

---

## 🎯 ユーザー層について

### メインターゲット

* **属性：** 一人暮らしの個人ユーザー
* **スキル：** 料理初心者（レシピを見れば作れるが、献立決めが負担）
* **生活スタイル：** 自炊多め〜中食多め
* ※コンビニ弁当／ファストフードは「中食」として扱う


* **利用シーン：** スマホ中心
* **プライバシー：** 個人情報は扱わない（従業員名・健康状態・取引先情報などは扱わない）

> **Note:** 家庭を持っていても使える余地は残しつつ、設計を散らかさないため **MVPは「個人」軸**で作ります。

---

## 🚫 一番潰したい失敗（＝解決したい課題）

**献立迷い（買い物前に家で迷う）**  
「何を作るか決められない」「検索ワードの試行錯誤で疲れる」ことで、時間が溶けたり自炊を諦めてしまう状態。


## ユーザーの課題と解決アプローチ

### 課題（ケ）：献立を“決める”のがしんどい
- 何を作るか決められず、買い物前に家で迷って時間が溶ける
- 検索ワードの試行錯誤で疲れる（検索しても決めきれない）

### アプローチ（ケ）：決める工程を「選ぶだけ」に圧縮する
- 入力は選択式（自炊/中食、買い物/家にある、時間、気分）
- アプリが **料理名の候補を3つ提示**し、選択肢を固定する
- 各候補は **ワンタップでGoogle検索結果へ**（検索語入力の手間をなくす）

### 課題（ハレ）：良かった行動が残らず、日常が単調で続かない
- 小さな満足が積み上がらず、日々の「ちゃんとできた」が流れてしまう
- 食の楽しみが継続しづらい（振り返りがない）

### アプローチ（ハレ）：主観でOKの“プチハレ”を記録し、可視化して継続させる
- ハレタグ（ボタン）＋ひとことの短文で記録
- カレンダースタンプ＋ポイント＋見た目変化で「積み上げ」を見える化
- 記録が“自分のネタ帳”になり、次回の迷い軽減（ケ）にもつながる
## 📱 サービスの利用イメージ

### ケ（献立迷いを止める）

1. アプリを開き、まず **「自炊／中食」** を選ぶ
2. 自炊の場合は **「今から買いに行く／家にあるもので作る」** も選ぶ
3. 所要時間（10分刻み）と気分タグ（最小セット）を入れる
4. アプリが **料理名の候補を3つ提示**する（例：回鍋肉／親子丼／豚汁）
5. 候補から **ワンタップでGoogle検索結果へ**移動する（検索語入力は不要）

* ※レシピ本文は外部サイトで検索（アプリはレシピDBを抱えない）


### ハレ（ハレを足して残す）

1. 「今日はハレを足した」と感じたら記録する（ハレ判定は主観でOK）
2. **ハレタグ（ボタン）**を選ぶ（例：新作／限定／予算UP）
* ※予算UPの目安：500円以上


3. 投稿を「自分だけ／全体公開」で保存
4. カレンダーにスタンプが押され、ポイントと見た目変化が進む

---

## 🎨 UIイメージ（Wireframe）
画面遷移図や開発が進んだら張り替える予定あり。

### ホーム画面

現在の「ハレ度」を確認し、次の行動（検索 or 記録）を選択します。

```text
+-----------------------------------+
|      現在のハレ度: Lv.5 (18pt)    |
|         ( 🌱 ) [  絵  ]           |
|-----------------------------------|
|  [ 今日のごはん、どうする？ ]     |
|   👉 迷いを減らす (ケ)            |
|-----------------------------------|
|  [ 今日、なにか良いことあった？ ] |
|   ✨ ハレを記録する (ハレ)        |
+-----------------------------------+

```

### 献立相談画面（ケ）

最小限の入力で、**料理名の候補を3つ提示**し、ワンタップで外部検索へ移動します。
※特定レシピサイトに固定せず、検索結果を入口にすることで、ユーザーが普段使う情報源（レシピサイト/動画等）を選べる設計にしています。

```text
+-----------------------------------+
| 🔍 ごはん相談                     |
|  < スタイル > ( 自炊 ) ( 中食 )   |
|  < 時間 >     10分 --o-- 60分     |
|  < 気分 >     (和食) (ガッツリ)   |
|-----------------------------------|
|       [ 候補を出す 🪄 ]           |
|-----------------------------------|
| 💡 候補: 回鍋肉 / 親子丼 / 豚汁    |
|  [ Googleで回鍋肉を検索 ↗ ]       |
+-----------------------------------+

```
## 🌟 サービスの差別化ポイント・推しポイント

### 前提：よくある類似サービス（例）
- **レシピ検索/献立提案系**：アプリ内でレシピを探す／おすすめを受け取る（検索・提案が主役）
- **栄養管理/食事記録系**：摂取量・栄養バランスの記録や改善が主目的（健康が主役）
- **写真/SNS投稿系**：食事写真・レビュー・他者反応（いいね等）が主目的（共有が主役）

ケハレ帖（仮）は、上記と一部重なる要素はありつつ、**主軸を「迷いの解消」と「プチハレの継続」に置く**点が異なります。

---

### 差別化ポイント1：レシピ提供ではなく「決める工程の圧縮」に集中
多くのサービスは「レシピを探す/提案する」こと自体が中心になりがちです。  
本サービスは、献立迷いの本体である **“決めるまでの迷い”** と **“検索語の試行錯誤”** を減らすことに集中します。

- 入力は選択式（自炊/中食、買い物/家にある、時間、気分）
- **料理名の候補を3つ提示**（意思決定を圧縮）
- **ワンタップでGoogle検索結果へ**（検索語入力を不要にする）
- 特定サイトに固定しないため、ユーザーは **普段使う情報源（レシピサイト/動画等）を選べる**

**この差別化が優れている点**
- 「検索しても決められない」を起こしにくく、最短で行動に移れる
- レシピDBを抱えずに成立するため、MVPでも運用負荷を抑えつつ検証できる

---

### 差別化ポイント2：「ハレ（小さな特別）」を主観で記録し、日常を育てる
既存の食事記録は「健康」「栄養」「写真映え」などが主目的になりがちです。  
本サービスは **主観でOKな“プチハレ”** を残して、日常の満足感と継続を作ります。

- ハレタグ（新作/限定/予算UPなど）＋短文で記録
- **カレンダースタンプ＋ポイント＋見た目変化**で積み上げを可視化
- 記録が「自分のハレのネタ帳」になり、次回の迷い（ケ）にも効く

**この差別化が優れている点**
- 完璧な自炊や健康管理を求めず、続けやすい
- “良かった行動”を積み上げられ、モチベーションが持続する

---

### 推しポイント（このサービスならでは）
- **ケ（迷い軽減）×ハレ（記録/可視化）**のループで、  
  「決められない」→「行動できた」→「残る」→「次が少し楽」の体験を作る
- パティシエ/食品現場の経験を背景に、  
  「季節感・香り・盛り付け・余韻」など“体験としての食”を、ログ体験の設計に落とし込む
---

## 🚀 MVPと本リリースの方針

### MVP（Minimum Viable Product）
* 入力（自炊/中食・買い物/家にある・時間・気分）をもとに **料理名の候補を3つ提示**する
* 各候補から **ワンタップでGoogle検索結果へ**移動できる（検索語入力を不要にする）
* ハレの記録（スタンプ＋ポイント＋見た目変化）
* 全体公開はログイン必須（匿名投稿なし）
* 運用負荷の高い安全機能は後回し（通報など）

### 本リリース
* 候補提示の精度向上（履歴・好みによる並び替え/パーソナライズ）
* AI等による候補生成（必要に応じて）
* 交流機能（いいね/コメント/ブックマーク）
* 安全機能（通報、削除依頼窓口、運営の非表示 など）

---

## 🛠 機能候補

### MVPで作りたいもの

* **認証：** ログイン必須
* **投稿（ハレログ）：**
* 公開範囲：自分だけ／全体公開
* 全体公開はログイン必須（匿名投稿なし）
* 投稿テキスト上限：**280文字**（調整余地あり）
* 画像投稿：MVPは無し


* **ハレタグ（ボタン）：** 初期セット（新作／限定／予算UP）
* **ケ（迷い軽減）：**
* 入力：自炊/中食、（自炊なら）買い物/家にある、所要時間（10分刻み）、気分タグ（最小セット）
* 出力：**料理名の候補3つ**＋各候補の **Google検索リンク（ワンタップ）**


* **カレンダー：** 月表示＋ハレスタンプ
* **ゲーミフィケーション：** ポイント付与＋簡易的な見た目変化（段階は最小）

### MVP後に追加するもの（本リリース側）

* AIによる候補生成・パーソナライズ
* 「材料欄をまとめて貼る」→行分割＆抽出→買い物リスト化（単位：個/g/ml）→売り場カテゴリ分け
* いいね／コメント／ブックマーク等の交流機能

### 安全機能（本リリース側）

* 通報ボタン
* 削除依頼窓口＋運営の非表示

---

## 🌟 ポイント・見た目段階（MVP中の想定）

### 付与ルール（案）

* **ハレ投稿：** +1
* **予算UP（500円以上）：** 追加 +1（合計 +2）
* **日次上限：** 3pt

### 段階（stage）（案）

* 0 / 5 / 15 / 30 / 50
* ※ここはユーザーテストで調整余地あり。



---

## 💻 技術スタック・設計運用

ご要望に合わせて、技術スタックの表を「バックエンド」「フロントエンド」「その他（インフラ・開発環境）」の3つに分割し、Ruby 3.3.2の追加とRails 8.0の選定理由の更新を行いました。

以下のMarkdownをコピーして、READMEの該当箇所を差し替えてください。

---

## 💻 技術スタック・設計運用

### バックエンド

| 技術 | 選定理由・妥当性 |
| --- | --- |
| **Ruby 3.3.2** | YJIT（Just-In-Timeコンパイラ）によるパフォーマンス向上と、洗練された言語機能を享受するため。最新安定版として十分な実績があり、長期的なメンテナンス性を考慮して採用。 |
| **Ruby on Rails 8.0** | リリースから一定期間が経過し、エコシステムが安定してきたため採用。「The One Person Framework」思想により単独でモダンなWebアプリを完結できる点に加え、Solid Queue/Cache標準搭載によりRedis等が不要となり、インフラ構成の簡素化・コスト削減が可能。 |

### フロントエンド (Frontend)

| 技術 | 選定理由・妥当性 |
| --- | --- |
| Hotwire (Turbo + Stimulus) | React等のSPA導入による開発・学習コスト増を回避しつつ、高速な画面遷移と部分更新（SPA風体験）を実現するため。Rails 8との親和性が最も高い。 |
| Tailwind CSS + daisyUI | CSS設計（BEM等）の時間を削減するため。daisyUIによりセマンティックなクラス名で記述でき、UI構築速度を大幅に向上させる。 |

### その他・インフラ (Infrastructure & Tools)

| 技術 | 選定理由・妥当性 |
| --- | --- |
| Render | インフラ管理の手間を最小化するため。`git push`のみでデプロイが完了し、個人開発のリソースを機能開発に集中できる。 |
| Docker | 開発環境（Mac/Windows/Linux）の差異をなくし、セットアップ手順を統一するため。 |
| Node.js / Yarn | JavaScriptエコシステムの標準パッケージマネージャを使用（主にTailwind CSS等のビルドツール管理用）。 |
| PostgreSQL (Neon) | Railsのデファクトスタンダード。サーバーレス（Neon）を採用することで、未使用時のインスタンス停止などによるコスト最適化と、強力なブランチ機能による開発効率向上を狙う。 |
| Devise |Rails8でも認証機能（パスワードリセットやメール確認等）を自作できるが、工数を削減しMVPの早期リリースを優先するため。 |
| RSpec | 日本のRailsコミュニティにおける標準であり、ドキュメントが豊富。仕様書のように読めるテストコードにより、メンテナンス性を高める。 |



### 📂 ディレクトリ構成の主要ポイント

Rails 8標準構成に加え、以下の方針で配置します。

* **`app/services/`**: 外部検索クエリの生成ロジックや、複雑なビジネスロジック。
* **`app/javascript/controllers/`**: Stimulusコントローラー（ハレタグ選択時のUI挙動など）。
* **`db/seeds/`**: ハレタグ・料理候補（料理名）などの初期マスタデータ。

### 🌱 シードデータ（マスタ）の運用方針

「ハレタグ」や「料理候補（料理名）」などのマスタデータは `db/seeds.rb` で管理します。

* **冪等性（Idempotency）の担保:** `rails db:seed` は何度実行してもデータが重複しないよう、`find_or_create_by` 等を使用して記述します。
* **マスタ更新:** マスタの追加・修正はマイグレーションではなく `seeds.rb` を更新し、デプロイ時に `db:seed` を実行する運用とします。

---

## 🗄 DB構造（MVP想定）

### ざっくり方針

* マスタ（**ハレタグ**／料理候補）は `seed` で初期投入して改善しやすくする。
* ポイントは「後からルール変更・集計見直し」が起きるため、台帳（トランザクション）で残せる形にする。
* `stage` は累計ポイントから算出（キャッシュしたい場合は user に保持）。


### ER図（案）

```mermaid
erDiagram
  USERS ||--o{ HARE_ENTRIES : has
  HARE_ENTRIES ||--o{ HARE_ENTRY_TAGS : has
  HARE_TAGS ||--o{ HARE_ENTRY_TAGS : has

  USERS ||--o{ POINT_TRANSACTIONS : has
  HARE_ENTRIES ||--o{ POINT_TRANSACTIONS : produces

  GENRES ||--o{ MEAL_SEARCHES : used_by
  USERS ||--o{ MEAL_SEARCHES : has

  USERS {
    bigint id PK
    string email
    string encrypted_password
    string reset_password_token
    datetime reset_password_sent_at
    datetime remember_created_at
    datetime created_at
    datetime updated_at
  }

  HARE_ENTRIES {
    bigint id PK
    bigint user_id FK
    date occurred_on
    string visibility "private/public"
    text body "<= 280 chars"
    integer price_yen
    integer awarded_points
    string meal_mode "home_cook/ready_meal"
    string cook_context "shopping/pantry"
    integer minutes
    string mood_tag
    datetime created_at
    datetime updated_at
  }

  HARE_TAGS {   a
    bigint id PK
    string key
    string label
    integer position
    boolean active
    datetime created_at
    datetime updated_at
  }

  HARE_ENTRY_TAGS {
    bigint id PK
    bigint hare_entry_id FK
    bigint hare_tag_id FK
  }

  POINT_TRANSACTIONS {
    bigint id PK
    bigint user_id FK
    bigint hare_entry_id FK
    date occurred_on
    integer points
    string rule_key
    datetime created_at
  }

  GENRES {
    bigint id PK
    string key
    string label
    string base_keywords
    integer position
    boolean active
    datetime created_at
    datetime updated_at
  }

  MEAL_SEARCHES {
    bigint id PK
    bigint user_id FK
    bigint genre_id FK
    string meal_mode
    string cook_context
    integer minutes
    string mood_tag
    string query_text
    datetime created_at
  }

```
